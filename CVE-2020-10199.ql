
# code

```
// CVE: CVE-2020-10199 
// El 注入
// find buildConstraintViolationWithTemplate()
import java
import semmle.code.java.dataflow.FlowSources
// Method
class Template  extends Method{
   Template() {
       this.getDeclaringType().getASupertype*().hasQualifiedName("javax.validation", "ConstraintValidatorContext") and
       this.hasName("buildConstraintViolationWithTemplate") and this.getNumberOfParameters()=1
   }
}

// sink 数据流（留坑，写不出source）
class TemplateSourceMethodSink extends Expr{
    TemplateSourceMethodSink(){
exists(MethodAccess call, Method method |
      call.getArgument(0) = this and
      method = call.getMethod() and method instanceof Template
)
    }

}
from TemplateSourceMethodSink ts
select ts.getLocation(),ts

```

```
1	CleanupPolicyAssetNamePatternValidator:46	stripJavaEl(...)
2	CronExpressionValidator:57	stripJavaEl(...)
3	CronExpressionValidatorTest:61	any(...)
4	CronExpressionValidatorTest:66	"value {java el} {el}"
5	PrivilegesExistValidator:64	... + ...
6	PrivilegesExistValidator:77	... + ...
7	RoleNotContainSelfValidator:78	message
8	RolesExistValidator:64	... + ...
9	PrivilegesExistValidatorTest:51	any(...)
10	PrivilegesExistValidatorTest:57	"Invalid privilege id: dx27e{\"gggggggggggggggggggggggggggggggggggggggggggz\".toString().replace(\"g\", \"q\")}yv5rm. Only letters, digits, underscores(_), hyphens(-), dots(.), and asterisks(*) are allowed and may not start with underscore or dot."
11	PrivilegesExistValidatorTest:68	any(...)
12	RoleNotContainSelfValidatorTest:60	any(...)
13	RolesExistValidatorTest:48	any(...)
14	RolesExistValidatorTest:55	"Missing roles: [dx27e{\"gggggggggggggggggggggggggggggggggggggggggggz\".toString().replace(\"g\", \"q\")}yv5rm]"
15	ConstraintViolationFactory:121	stripJavaEl(...)
```
